title: Simple keyword detection rule for dev-tunnels
id: 6ecb74f5-a450-4183-90d8-2c12ac30b9c9
status: experimental
description:
- '''Dev tunnels allow developers to securely share local web services across the
  internet. Enabling you to connect your local development environment with cloud
  services and share work in progress with colleagues or aid in building webhooks'''
references:
- https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/overview
author: '@mthcht'
date: 2023/07/30
modified: 2023/08/30
tags:
- attack.T1021.003
- attack.T1090
- attack.T1105
- attack.TA0002
- attack.TA0005
- attack.TA0011
logsource:
  category:
  - network
falsepositives:
- Unknown
level:
- medium
detection:
  selection:
    url:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    dest_url:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    uri:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    uri_query:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    query:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    url_domain:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    uri_path:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    domain:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    QueryName:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    QueryResults:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    DestinationHostname:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    DestinationIp:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    http_referrer:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    http_referrer_domain:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    http_user_agent:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    dest_nt_host:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    sender:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    recipient:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    orig_recipient:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    subject:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    url.domain:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    url.full:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    url.original:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    url.query:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    user_agent.original:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    network.application:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    http.request.body.content:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    http.request.referrer:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    email.from.address:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    dns.question.name:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
    destination.domain:
    - '*devtunnel create *'
    - '*devtunnel.exe *'
    - '*devtunnel host -p *'
    - '*https://*.use.devtunnels.ms*'
  condition: selection
fields:
- url
- dest_url
- uri
- uri_query
- query
- url_domain
- uri_path
- domain
- QueryName
- QueryResults
- DestinationHostname
- DestinationIp
- http_referrer
- http_referrer_domain
- http_user_agent
- dest_nt_host
- sender
- recipient
- orig_recipient
- subject
- url.domain
- url.full
- url.original
- url.query
- user_agent.original
- network.application
- http.request.body.content
- http.request.referrer
- email.from.address
- dns.question.name
- destination.domain
