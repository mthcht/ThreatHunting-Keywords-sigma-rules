title: Simple keyword detection rule for bcdedit
id: 556e6f20-1d36-4c55-81ac-fc01e1f0c70e
status: experimental
description:
- '''Bcdedit is a command-line tool that enables users to view and make changes to
  boot configuration data (BCD) settings in Windows systems. Adversaries may leverage
  bcdedit to modify boot settings. such as enabling debug mode or disabling code integrity
  checks. as a means to bypass security mechanisms and gain persistence on the compromised
  system. By modifying the boot configuration. adversaries can evade detection and
  potentially maintain access to the system even after reboots.'''
references:
- N/A
author: '@mthcht'
date: 2023/07/30
modified: 2023/09/11
tags:
- attack.T1218.004
- attack.T1562.001
- attack.TA0007
- attack.TA0040
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- Unknown
detection:
  selection:
    ParentCommandLine:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    CommandLine:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    Details:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    registry.value:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    process.args:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    process.command_line:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    process.env_vars:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    process.io.text:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    process.title:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    pe.company:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    pe.description:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    pe.product:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    os.full:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    host.hostname:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    event.original:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    email.subject:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    device.model.name:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    container.image.name:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
    container.name:
    - '*bcdedit /set {default} recoveryenabled No*'
    - '*bcdedit /set {default} bootstatuspolicy ignoreallfailures*'
  condition: selection
fields:
- ParentCommandLine
- CommandLine
- Details
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.title
- pe.company
- pe.description
- pe.product
- os.full
- host.hostname
- event.original
- email.subject
- device.model.name
- container.image.name
- container.name
