title: Simple keyword detection rule for wevtutil
id: 26c2e66d-c404-4b7c-9203-83056fcd9467
status: experimental
description:
- '''adversaries can delete specific event logs or clear their contents. erasing potentially
  valuable information that could aid in detection. incident response. or forensic
  investigations. This tactic aims to hinder forensic analysis efforts and make it
  more challenging for defenders to reconstruct the timeline of events or identify
  malicious activities.'''
references:
- N/A
author: '@mthcht'
date: 2023/07/30
modified: 2023/09/01
tags:
- attack.T1070.004
- attack.T1562.001
- attack.TA0005
- attack.TA0040
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- critical
detection:
  selection:
    ParentCommandLine:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    CommandLine:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    Details:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    registry.value:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    process.args:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    process.command_line:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    process.env_vars:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    process.io.text:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    process.title:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    pe.company:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    pe.description:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    pe.product:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    os.full:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    host.hostname:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    event.original:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    email.subject:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    device.model.name:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    container.image.name:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
    container.name:
    - '*wevtutil cl *'
    - '*cmd* wevtutil.exe cl *'
  condition: selection
fields:
- ParentCommandLine
- CommandLine
- Details
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.title
- pe.company
- pe.description
- pe.product
- os.full
- host.hostname
- event.original
- email.subject
- device.model.name
- container.image.name
- container.name
