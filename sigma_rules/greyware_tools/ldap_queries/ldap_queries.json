[
    {
        "keyword": "*([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()*",
        "description": "get all trust relationships in the current domain",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*get-ADComputer -filter { PrimaryGroupID -eq \"516\" } -properties PrimaryGroupID*",
        "description": "cmdlets to get computer information about Domain Controllers",
        "tool_name": "ldap queries",
        "reference": "https://adsecurity.org/?p=299",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[adsisearcher]\"(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=2))\"*",
        "description": "find all disabled user accounts",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(objectClass=group)(managedBy=*)(groupType:1.2.840.113556.1.4.803:=2147483648))*",
        "description": "metasploit  enum_ad_managedby_groups.rb",
        "tool_name": "ldap queries",
        "reference": "https://github.com/rapid7/metasploit-framework/blob/d37a82500d1d08f9d8ab3da9b194653835748fae/modules/post/windows/gather/enum_ad_managedby_groups.rb#L59",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*([adsisearcher]'(&(objectCategory=user)(!(samAccountName=krbtgt)(servicePrincipalName=*)))').FindAll()*",
        "description": "Search for user accounts with SPN but not TGT accounts",
        "tool_name": "ldap queries",
        "reference": "https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(samAccountType=805306368)(servicePrincipalName=*)(!samAccountName=krbtgt)(!(UserAccountControl:1.2.840.113556.1.4.803:=2))(!msds-supportedencryptiontypes:1.2.840.113556.1.4.804:=24))*",
        "description": "Kerberoasting",
        "tool_name": "ldap queries",
        "reference": "https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*([adsisearcher]'(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=8192))').FindAll()*",
        "description": "Enumerate all Domain Controllers",
        "tool_name": "ldap queries",
        "reference": "https://web.archive.org/web/20240109000256/https://cyberdom.blog/2024/01/07/defender-for-identity-hunting-for-ldap/",
        "severity": "9",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[adsisearcher]\"(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))*",
        "description": "Detection of all accounts with 'Password Not Required'",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(&(objectCategory=person)(objectClass=user))(|(description=*pass*)(comment=*pass*)))*",
        "description": "metasploit enum_ad_user_comments",
        "tool_name": "ldap queries",
        "reference": "https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/hunting-for-reconnaissance-activities-using-ldap-search-filters/ba-p/824726",
        "severity": "8",
        "popularity": "4",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(samAccountType=805306368)(servicePrincipalName=*)(!samAccountName=krbtgt)(!(UserAccountControl:1.2.840.113556.1.4.803:=2))(msds-supportedencryptiontypes:1.2.840.113556.1.4.804:=24))*",
        "description": "Kerberoasting",
        "tool_name": "ldap queries",
        "reference": "https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(objectCategory=person)(objectClass=user)(serviceAccount=TRUE)*",
        "description": "Query to find service accounts which are typically high-privileged and targeted for privilege escalation",
        "tool_name": "ldap queries",
        "reference": "https://github.com/mthcht/ThreatHunting-Keywords",
        "severity": "8",
        "popularity": "5",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(msds-supportedencryptiontypes=0)(msds-supportedencryptiontypes:1.2.840.113556.1.4.803:=4)))*",
        "description": "used by Rubeus and S4UTomato tools",
        "tool_name": "ldap queries",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(objectCategory=computer)(ms-MCS-AdmPwd=*)(sAMAccountName=\" + target + \"))*",
        "description": "LAPS passwords (from SharpLAPS)",
        "tool_name": "ldap queries",
        "reference": "https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536)*",
        "description": "Enumerate all users with the account configuration 'Password never expires'",
        "tool_name": "ldap queries",
        "reference": "https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(userAccountControl:1.2.840.113556.1.4.803:=524288)*",
        "description": "Accounts Trusted for Delegation",
        "tool_name": "ldap queries",
        "reference": "https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*([adsisearcher]'(adminCount=1)').FindAll()*",
        "description": "Search for all objects with AdminSHHolder",
        "tool_name": "ldap queries",
        "reference": "https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(Get-ADForest).Domains | %{ Get-ADDomainController -Filter * -Server $_ }*",
        "description": "Enumerate all of the domain controllers for all domains in a forest",
        "tool_name": "ldap queries",
        "reference": "N/A",
        "severity": "6",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(objectclass=group)(samaccountname=*domain admins*))*",
        "description": "Enumerate Domain Administrators Group",
        "tool_name": "ldap queries",
        "reference": "https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(objectCategory=computer)(msDS-isRODC=TRUE))*",
        "description": "Enumerate Read-Only Domain Controllers (RODC)",
        "tool_name": "ldap queries",
        "reference": "https://github.com/mthcht/ThreatHunting-Keywords",
        "severity": "8",
        "popularity": "5",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-ADUser -filter * -Properties SamAccountName, PasswordNotRequired | where { $_.passwordnotrequired -eq \"true\" } | where {$_.enabled -eq \"true\"}*",
        "description": "identifying accounts with 'Password Not Required",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[ADSI]* | Select-Object -Property *lockoutThreshold*",
        "description": "enumeration of Domain Password Policies",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[adsisearcher]'(&(objectCategory=computer)(primaryGroupID=516))').FindAll()*",
        "description": "Enumerate all Domain Controllers",
        "tool_name": "ldap queries",
        "reference": "https://web.archive.org/web/20240109000256/https://cyberdom.blog/2024/01/07/defender-for-identity-hunting-for-ldap/",
        "severity": "9",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*([adsisearcher]'(&(objectCategory=computer)(!(primaryGroupID=516)(userAccountControl:1.2.840.113556.1.4.803:=524288)))').FindAll()*",
        "description": "Enumerate all servers configured for Unconstrained Delegation",
        "tool_name": "ldap queries",
        "reference": "N/A",
        "severity": "9",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[adsisearcher]'(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32))').FindAll()*",
        "description": "Enumerate all accounts that do not require a password",
        "tool_name": "ldap queries",
        "reference": "https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Domains*",
        "description": "Queries for domain level and mode information",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536)(memberOf=CN=Administrators*",
        "description": "Enumerate Accounts with Non-Expiring Passwords and Administrative Privileges",
        "tool_name": "ldap queries",
        "reference": "https://github.com/mthcht/ThreatHunting-Keywords",
        "severity": "8",
        "popularity": "5",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell*[adsisearcher]*(objectcategory=group)*findAll()*",
        "description": "Red Teams and adversaries may leverage [Adsisearcher] to enumerate domain groups for situational awareness and Active Directory Discovery",
        "tool_name": "ldap queries",
        "reference": "https://research.splunk.com/endpoint/089c862f-5f83-49b5-b1c8-7e4ff66560c7/",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-ADUser -properties * -filter {(lastlogondate -notlike \"*\" -OR lastlogondate -le $90days) -AND (passwordlastset -le $90days) -AND (enabled -eq $True) -and (PasswordNeverExpires -eq $false) -and (whencreated -le $90days)}*",
        "description": "querying accounts that have not been logged into for over 90 days",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[adsisearcher]*(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=66048)(!(userAccountControl:1.2.840.113556.1.4.803:=2))*",
        "description": "ADSI query to retrieve all active user accounts with non-expiring passwords",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[adsisearcher]\"(&(objectCategory=person)(objectClass=user)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))\"; $users = $searchUsers.FindAll(); $userProps = $users.Properties; $userProps | Where-Object {$_.description}*",
        "description": "find user descriptions in Active Directory:",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(objectclass=group)(samaccountname=domain admins)*",
        "description": "Enumerate Domain Admins",
        "tool_name": "ldap queries",
        "reference": "https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*(&(samAccountType=805306368)(servicePrincipalName=*)(!samAccountName=krbtgt)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))*",
        "description": "Kerberoasting",
        "tool_name": "ldap queries",
        "reference": "https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[ADSI]*LDAP://CN=Domain Admins*| ForEach-Object {[adsi]\"LDAP://$_\"}; *.distinguishedname*",
        "description": "enumeration of Domain Admins group members",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[ADSI]*LDAP://dc=* | Select -Property pwdProperties*",
        "description": "get LDAP properties for password settings directly",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest().GlobalCatalogs*",
        "description": "Discover all Global Catalogs in the forest using ADSI",
        "tool_name": "ldap queries",
        "reference": "https://adsecurity.org/?p=299",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Sites | *",
        "description": "enumeration of AD Forest Sites",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[ADSI]* | Select-Object -Property *minPwdLength*",
        "description": "enumeration of Domain Password Policies",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().DomainControllers*",
        "description": "Discover all Domain Controller in the domain using ADSI",
        "tool_name": "ldap queries",
        "reference": "https://adsecurity.org/?p=299",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).FindAllDomainControllers() | Select-Object -Property *",
        "description": "querying all domain controllers with detailed properties",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[ADSI]* | Select-Object -Property *lockoutDuration*",
        "description": "enumeration of Domain Password Policies",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[adsisearcher]\"(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=2560)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))\"*",
        "description": "get a count of all inter domain trust accounts",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest().RootDomain.PDCRoleOwner.Name*",
        "description": "query for the primary domain controller within the forest",
        "tool_name": "ldap queries",
        "reference": "https://github.com/swarleysez/AD-common-queries",
        "severity": "8",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139",
        "endpoint_detection": true,
        "network_detection": false
    }
]