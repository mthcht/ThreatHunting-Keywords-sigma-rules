[
    {
        "keyword": "*Find-LocalAdminAccess -Verbose*",
        "description": "Find machine where the user has admin privs",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1069.002 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*https://*Microsoft.ActiveDirectory.Management.dll*",
        "description": "redteam technique - import the ActiveDirectory module without the need to install it on the current computer - the dll has been extracted from a Windows 10 x64 with RSAT installed",
        "tool_name": "powershell",
        "reference": "https://github.com/mthcht/Purpleteam/blob/main/Simulation/Windows/ActiveDirectory/Bruteforce.ps1",
        "severity": "N/A",
        "popularity": "2",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0006",
        "techniques": "T1110.001 - T1110.003 - T1110.004",
        "endpoint_detection": true,
        "network_detection": true
    },
    {
        "keyword": "*rundll32.exe C:\\windows\\System32\\comsvcs.dll MiniDump (Get-Process lsass).id*",
        "description": "credential dumping activity",
        "tool_name": "powershell",
        "reference": "https://www.trendmicro.com/en_us/research/22/g/analyzing-penetration-testing-tools-that-threat-actors-use-to-br.html",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0006",
        "techniques": "T1003.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\:MLKH*",
        "description": "powershell obfuscations techniques observed by malwares - reversed HKLM:\\",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0003 - TA0005 - TA0006",
        "techniques": "T1021 - T1024 - T1027 - T1035 - T1059 - T1070",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-LoggedonLocal -ComputerName *",
        "description": "PowerView get Locally logged users on a machine",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1069.002 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Invoke-UserHunter -CheckAccess*",
        "description": "Check local admin access for the current user where the targets are found",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0002 - TA0007 - TA0040",
        "techniques": "T1078.003 - T1046 - T1087.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-MpComputerStatus*",
        "description": "Gets the status of antimalware software on the computer.",
        "tool_name": "powershell",
        "reference": "https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0007",
        "techniques": "T1063",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*=resu ten*",
        "description": "powershell obfuscations techniques observed by malwares - reversed net user",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0003 - TA0005 - TA0006",
        "techniques": "T1021 - T1024 - T1027 - T1035 - T1059 - T1070",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell New-ItemProperty -Path *HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender* -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force*",
        "description": "Defense evasion technique In order to avoid detection at any point of the kill chain. attackers use several ways to disable anti-virus. disable Microsoft firewall and clear logs.",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0007 - TA0040 - TA0005",
        "techniques": "T1562.001 - T1562.002 - T1070.004",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\ataDmargorP\\:C*",
        "description": "powershell obfuscations techniques observed by malwares - reversed strings",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-MpPreference -DisableRealtimeMonitoring $true*",
        "description": "Defense evasion technique In order to avoid detection at any point of the kill chain. attackers use several ways to disable anti-virus. disable Microsoft firewall and clear logs.",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0007 - TA0040 - TA0005",
        "techniques": "T1562.001 - T1562.002 - T1070.004",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe wget http://[0-9]{1,3}*",
        "description": "downloading from IP without domain name",
        "tool_name": "powershell",
        "reference": "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "only the regex part matters",
        "tactics": "TA0009",
        "techniques": "T1105",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*reg add * EnableScriptBlockLogging /t REG_DWORD /d 0*",
        "description": "disable powershell logging",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0043",
        "techniques": "T1484.001 - T1112 - T1491.001 - T1490 - T1036.001 - T1089",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Remove-Item (Get-PSreadlineOption).HistorySavePath*",
        "description": "Delete powershell history",
        "tool_name": "powershell",
        "reference": "https://github.com/hak5/omg-payloads/tree/master/payloads/library/credentials/-OMG-Credz-Plz",
        "severity": "10",
        "popularity": "8",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0004 - TA0040 - TA0010",
        "techniques": "T1056.002 - T1566.001 - T1567.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-ADComputer -Filter {TrustedForDelegation -eq $True}",
        "description": "AD Module Enumerate computers with Unconstrained Delegation",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0008 - TA0011",
        "techniques": "T1021.004 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-ADGroup -Filter *Name -like *admin*",
        "description": "AD Module Search for a particular string in attributes (admin)",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087.002 - T1018 - T1069.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\\\ataDmargorP\\\\:C*",
        "description": "powershell obfuscations techniques observed by malwares - reversed strings",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe curl http://[0-9]{1,3}*",
        "description": "downloading from IP without domain name",
        "tool_name": "powershell",
        "reference": "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "only the regex part matters",
        "tactics": "TA0009",
        "techniques": "T1105",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*cmd.exe /Q /c powershell.exe -exec bypass -noni -nop -w 1 -C *\\temp*",
        "description": "likely associated with a PowerShell-based exploit kit such as PowerSploit or Empire",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0002 - TA0003 - TA0005 - TA0008 - TA0040",
        "techniques": "T1059.001 - T1059.003 - T1086 - T1027 - T1105 - T1059.005 - T1059.006 - T1059.007",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\swodniW\\:C*",
        "description": "powershell obfuscations techniques observed by malwares - reversed strings",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*New-ItemProperty * \"EnableScriptBlockLogging\" -PropertyType DWord -Value 0*",
        "description": "disable powershell logging",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0043",
        "techniques": "T1484.001 - T1112 - T1491.001 - T1490 - T1036.001 - T1089",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*[Reflection.Assembly]::LoadWithPartialName('System.Core').GetType('System.Diagnostics.Eventing.EventProvider').GetField('m_enabled'*'NonPublic*Instance').SetValue([Ref].Assembly.GetType('System.Management.Automation.Tracing.PSEtwLogProvider').GetField('etwProvider'*'NonPublic*Static').GetValue($null)*0)*",
        "description": "impair the defenses of the targeted system by disabling ETW logging for PowerShell. This can make it difficult for security teams to monitor and analyze PowerShell activities on the system potentially allowing adversaries to perform malicious actions without being detected",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0040",
        "techniques": "T1562",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Invoke-SDPropagator*",
        "description": "propagation of ACL changes on the 'AdminSDHolder' container. which can be used to maintain unauthorized access or escalate privileges in the targeted environment. The 'AdminSDHolder' container plays a crucial role in managing the security of protected groups in Active Directory. and forcing ACL changes to propagate may lead to unintended security consequences.",
        "tool_name": "powershell",
        "reference": "https://github.com/theyoge/AD-Pentesting-Tools/blob/main/Invoke-SDPropagator.ps1",
        "severity": "N/A",
        "popularity": "1",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0003",
        "techniques": "T1222",
        "endpoint_detection": true,
        "network_detection": true
    },
    {
        "keyword": "*\\powershell.exe* =hidden*",
        "description": "command aiming to hide a file.  It can be performed with  powershell on a WINDOWS machine with command option =hidden",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0040 - TA0002",
        "techniques": "T1562.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "* resu ten*",
        "description": "powershell obfuscations techniques observed by malwares - reversed net user",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Powershell.exe  -windowstyle hidden -nop -ExecutionPolicy Bypass  -Commmand *C:\\Users\\*\\AppData\\Roaming\\*",
        "description": "Adversaries may attempt to execute powershell script from known accessible location",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0002 - TA0006",
        "techniques": "T1059.001 - T1036 - T1216",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "* imaohw*",
        "description": "powershell obfuscations techniques observed by malwares - reversed net user",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-MpPreference -DisableBehaviourMonitoring True*",
        "description": "Windows defender disable protection",
        "tool_name": "powershell",
        "reference": "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005",
        "techniques": "T1562.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*ls env:USERNAME*",
        "description": "alternativeto whoami",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "3",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007",
        "techniques": "T1033 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-MpPreference -ExclusionProcess *\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe*",
        "description": "Exclude powershell from defender detections",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0007 - TA0040 - TA0005",
        "techniques": "T1562.001 - T1562.002 - T1070.004",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*cilbuP\\sresU\\:C*",
        "description": "powershell obfuscations techniques observed by malwares - reversed strings",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe -NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc *",
        "description": "CrackMapExec behavior",
        "tool_name": "powershell",
        "reference": "https://github.com/Porchetta-Industries/CrackMapExec",
        "severity": "N/A",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0007 - TA0008",
        "techniques": "T1021 - T1048 - T1077 - T1087 - T1090 - T1135 - T1210",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell*Uninstall-WindowsFeature -Name Windows-Defender-GUI*",
        "description": "Windows Defender tampering technique ",
        "tool_name": "powershell",
        "reference": "https://thedfirreport.com/2023/04/03/malicious-iso-file-leads-to-domain-wide-ransomware/",
        "severity": "10",
        "popularity": "8",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0040",
        "techniques": "T1562.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-DomainComputer -TrustedToAuth",
        "description": "AD Module Enumerate principals with Constrained Delegation enabled",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0008 - TA0011",
        "techniques": "T1021.004 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Invoke-EnumerateLocalAdmin -Verbose*",
        "description": "Find local admins on the domain machines",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1069.002 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-ADUser -Filter {TrustedForDelegation -eq $True}",
        "description": "AD Module Enumerate computers with Unconstrained Delegation",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0008 - TA0011",
        "techniques": "T1021.004 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-DomainUser -TrustedToAuth",
        "description": "AD Module Enumerate principals with Constrained Delegation enabled",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0008 - TA0011",
        "techniques": "T1021.004 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*reg add * EnableModuleLogging /t REG_DWORD /d 0*",
        "description": "disable powershell logging",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0043",
        "techniques": "T1484.001 - T1112 - T1491.001 - T1490 - T1036.001 - T1089",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*cilbuP\\\\sresU\\\\:C*",
        "description": "powershell obfuscations techniques observed by malwares - reversed strings",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-Clipboard -Value ''*",
        "description": "Clearing the clipboard is a deliberate attempt to cover tracks and make the attack less detectable",
        "tool_name": "powershell",
        "reference": "https://github.com/PaloAltoNetworks/Unit42-timely-threat-intel/blob/main/2024-05-14-IOCs-for-DarkGate-activity.txt",
        "severity": "10",
        "popularity": "2",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005",
        "techniques": "T1070",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-NetGroupMember -GroupName *DNSAdmins*",
        "description": "the command is used to discover the members of a specific domain group DNSAdmins which can provide an adversary with valuable information about the target environment. The knowledge of group members can be exploited by attackers to identify potential targets for privilege escalation or Lateral Movement within the network.",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0007",
        "techniques": "T1069.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "[Environment]::UserName*",
        "description": "alternativeto whoami",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "3",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007",
        "techniques": "T1033 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-NetGroup -FullData*",
        "description": "Find groups in the current domain (PowerView)",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1069.002 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-DnsClientDohServerAddress *-ServerAddress *",
        "description": "adding a DNS over HTTPS server with powershell",
        "tool_name": "powershell",
        "reference": "https://learn.microsoft.com/en-us/powershell/module/dnsclient/add-dnsclientdohserveraddress?view=windowsserver2022-ps",
        "severity": "9",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0040 - TA0005",
        "techniques": "T1568.003 - T1049 - T1562.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe Invoke-WebRequest http://[0-9]{1,3}*",
        "description": "downloading from IP without domain name",
        "tool_name": "powershell",
        "reference": "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "only the regex part matters",
        "tactics": "TA0009",
        "techniques": "T1105",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://[0-9]{1,3}*",
        "description": "downloading from IP without domain name",
        "tool_name": "powershell",
        "reference": "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "only the regex part matters",
        "tactics": "TA0009",
        "techniques": "T1105",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-AppLockerPolicy -Effective *",
        "description": "AppLocker Get AppLocker policy",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0043",
        "techniques": "T1592",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-ADObject -SearchBase *CN=Shadow Principal Configuration*CN=Services* (Get-ADRootDSE).configurationNamingContext) | select *msDS-ShadowPrincipalSid*",
        "description": "Enumerate shadow security principals mapped to a high priv group",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1069.002 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*enable-psremoting -force*",
        "description": "enables WinRM",
        "tool_name": "powershell",
        "reference": "https://github.com/alperenugurlu/AD_Enumeration_Hunt/blob/alperen_ugurlu_hack/AD_Enumeration_Hunt.ps1",
        "severity": "10",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0008 - TA0005",
        "techniques": "T1077 - T1021",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-NetUser -SPN*",
        "description": "PowerView Find users with SPN",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1069.002 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-MpPreference -DisableBehaviorMonitoring True*",
        "description": "Windows defender disable protection",
        "tool_name": "powershell",
        "reference": "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005",
        "techniques": "T1562.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*gci env:USERNAME*",
        "description": "alternativeto whoami",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "3",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007",
        "techniques": "T1033 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*rundll32.exe C:\\Users\\Public\\*",
        "description": "Defense evasion technique",
        "tool_name": "powershell",
        "reference": "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005",
        "techniques": "T1218.011",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Invoke-WebRequest ifconfig.me/ip*Content.Trim()",
        "description": "C2 server to connect to a victim machine via reverse shell",
        "tool_name": "powershell",
        "reference": "https://github.com/reveng007/C2_Server",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0011 ",
        "techniques": "T1090 - T1090.001 - T1071 - T1071.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "* -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force*",
        "description": "Defense evasion technique In order to avoid detection at any point of the kill chain. attackers use several ways to disable anti-virus. disable Microsoft firewall and clear logs.",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0007 - TA0040 - TA0005",
        "techniques": "T1562.001 - T1562.002 - T1070.004",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Clear-RecycleBin -Force -ErrorAction SilentlyContinue*",
        "description": "Deletes contents of recycle bin",
        "tool_name": "powershell",
        "reference": "https://github.com/hak5/omg-payloads/tree/master/payloads/library/credentials/-OMG-Credz-Plz",
        "severity": "10",
        "popularity": "8",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0004 - TA0040 - TA0010",
        "techniques": "T1056.002 - T1566.001 - T1567.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-DomainUser -KerberosPreuthNotRequired -Verbose*",
        "description": "Powerview Enumerate users",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1069.002 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Import-Module *Microsoft.ActiveDirectory.Management.dll*",
        "description": "redteam technique - import the ActiveDirectory module without the need to install it on the current computer - the dll has been extracted from a Windows 10 x64 with RSAT installed",
        "tool_name": "powershell",
        "reference": "https://github.com/mthcht/Purpleteam/blob/main/Simulation/Windows/ActiveDirectory/Bruteforce.ps1",
        "severity": "N/A",
        "popularity": "2",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0006",
        "techniques": "T1110.001 - T1110.003 - T1110.004",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*=imaohw*",
        "description": "powershell obfuscations techniques observed by malwares - reversed whoami",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0003 - TA0005 - TA0006",
        "techniques": "T1021 - T1024 - T1027 - T1035 - T1059 - T1070",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*//:ptth*",
        "description": "powershell obfuscations techniques observed by malwares - reversed http://",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\\\swodniW\\\\:C*",
        "description": "powershell obfuscations techniques observed by malwares - reversed strings",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "powershell.exe -nop -c \"start-job *Import-Module BitsTransfer*$env:temp*GetRandomFileName()*Start-BitsTransfer -Source 'http*Remove-Item*Receive-Job*",
        "description": "deployment of a payload through a PowerShell stager using bits to download",
        "tool_name": "powershell",
        "reference": "https://thedfirreport.com/2023/09/25/from-screenconnect-to-hive-ransomware-in-61-hours/",
        "severity": "8",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0009",
        "techniques": "T1197",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-ADObject -Filter {msDS-AllowedToDelegateTo * -Properties msDS-AllowedToDelegateTo*",
        "description": "AD Module Enumerate principals with Constrained Delegation enabled",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0008 - TA0011",
        "techniques": "T1021.004 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "cmd.exe /c PowerShell.exe -Exec ByPass -Nol -Enc *",
        "description": "Jenkins Abuse Without admin access",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0001 - TA0007 - TA0040",
        "techniques": "T1210.002 - T1078.003 - T1046",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*New-Object System.Net.Sockets.TCPClient(*$stream = $client.GetStream()*[byte[]]$bytes = 0..65535*",
        "description": "Powershell reverse shell",
        "tool_name": "powershell",
        "reference": "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md",
        "severity": "N/A",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0002 - TA0008",
        "techniques": "T1105 - T1021.001 - T1021.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-ItemProperty * \"EnableScriptBlockLogging\" -Value 0*",
        "description": "disable powershell logging",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0043",
        "techniques": "T1484.001 - T1112 - T1491.001 - T1490 - T1036.001 - T1089",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-ADUser -Filter {DoesNotRequirePreAuth -eq $True} -Properties DoesNotRequirePreAuth",
        "description": "AD module Enumerate users",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0008 - TA0011",
        "techniques": "T1021.004 - T1087.002 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Remove-ItemProperty *HKLM:\\SOFTWARE\\YourSoftware\\Schedule\\TaskCache\\Tree\\* -Name *SD*",
        "description": "the threat actor deleted the SD value within the Tree registry path (hide scheduled task creation)",
        "tool_name": "powershell",
        "reference": "https://www.microsoft.com/en-us/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/",
        "severity": "9",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "risk of False positive",
        "tactics": "TA0005",
        "techniques": "T1562",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-PswaAuthorizationRule -UsernName \\* -ComputerName \\* -ConfigurationName \\*",
        "description": "allows all users to access all computers with a specified configuration",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0003",
        "techniques": "T1053",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*gci -h C:\\pagefile.sys*",
        "description": "commands from wmiexec2.0 -  is the same wmiexec that everyone knows and loves (debatable). This 2.0 version is obfuscated to avoid well known signatures from various AV engines.",
        "tool_name": "powershell",
        "reference": "https://github.com/ice-wzl/wmiexec2",
        "severity": "9",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1047 - T1027 - T1059",
        "endpoint_detection": true,
        "network_detection": true
    },
    {
        "keyword": "*Set-Clipboard -Value ' '*",
        "description": "Clearing the clipboard is a deliberate attempt to cover tracks and make the attack less detectable",
        "tool_name": "powershell",
        "reference": "https://github.com/PaloAltoNetworks/Unit42-timely-threat-intel/blob/main/2024-05-14-IOCs-for-DarkGate-activity.txt",
        "severity": "10",
        "popularity": "2",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005",
        "techniques": "T1070",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-ADComputer * -Properties PrincipalsAllowedToDelegateToAccount*",
        "description": "Command to get the list of accounts with PrincipalsAllowedToDelegateToAccount (used to exploit Bronze Bit Attack)",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0005 - TA0006 - TA0008",
        "techniques": "T1003 - T1057 - T1087 - T1482 - T1136",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*//:sptth*",
        "description": "powershell obfuscations techniques observed by malwares - reversed https://",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1027 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-MpPreference -DisDisableRealtimeMonitoring True*",
        "description": "Windows defender disable protection",
        "tool_name": "powershell",
        "reference": "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005",
        "techniques": "T1562.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-MpPreference -DisableIOAVProtection $true*",
        "description": "Disable scanning all downloaded files and attachments",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0007 - TA0040 - TA0005",
        "techniques": "T1562.001 - T1562.002 - T1070.004",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Get-GPO -All",
        "description": "AD Module GroupPolicy - List of GPO in the domain",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0007 - TA0009",
        "techniques": "T1087.002 - T1018 - T1069.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\powershell.exe* = hidden*",
        "description": "command aiming to hide a file. It can be performed with  powershell on a WINDOWS machine with command option =hidden",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0040 - TA0002",
        "techniques": "T1562.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging\" -Name \"EnableModuleLogging\" -Value 0*",
        "description": "disable powershell logging",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0043",
        "techniques": "T1484.001 - T1112 - T1491.001 - T1490 - T1036.001 - T1089",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-MpPreference -ExclusionPath *",
        "description": "Windows Defender evasion add an exclusion directory for your shady stuff",
        "tool_name": "powershell",
        "reference": "https://casvancooten.com/posts/2020/11/windows-active-directory-exploitation-cheat-sheet-and-command-reference",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "N/A",
        "techniques": "T1548 T1562 T1027 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe iwr http://[0-9]{1,3}*",
        "description": "downloading from IP without domain name",
        "tool_name": "powershell",
        "reference": "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html",
        "severity": "6",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "only the regex part matters",
        "tactics": "TA0009",
        "techniques": "T1105",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*azuread_decrypt_msol_*.ps1*",
        "description": "method of dumping the MSOL service account (which allows a DCSync) used by Azure AD Connect Sync",
        "tool_name": "powershell",
        "reference": "https://gist.github.com/analyticsearch/7453d22d737e46657eb57c44d5cf4cbb",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0006",
        "techniques": "T1003.006",
        "endpoint_detection": true,
        "network_detection": true
    },
    {
        "keyword": "*powershell.exe -exec bypass -noni -nop -w 1 -C*",
        "description": "command pattern used by crackmapexec by default A swiss army knife for pentesting networks",
        "tool_name": "powershell",
        "reference": "https://github.com/Porchetta-Industries/CrackMapExec",
        "severity": "N/A",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "High risk of false positive",
        "tactics": "N/A",
        "techniques": "T1210  T1570 T1021 T1595 T1592 T1589 T1590 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell -c *\\windows\\system32\\inetsrv\\appcmd.exe list apppool /@t:*",
        "description": "NetExec (a.k.a nxc) is a post-exploitation tool that helps automate assessing the security of large Active Directory networks.",
        "tool_name": "powershell",
        "reference": "https://github.com/Pennyw0rth/NetExec",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "Checking For Hidden Credentials With Appcmd.exe",
        "tactics": "TA0007 - TA0003 - TA0002 - TA0001",
        "techniques": "T1069 - T1021 - T1136 - T1018",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Get-DhcpServerv4Scope | Set-DhcpServerv4OptionValue -DnsServer *",
        "description": "set the DNS server configuration",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0040 - TA0005",
        "techniques": "T1557 - T1584",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-MpPreference -ExclusionExtension exe*",
        "description": "exclude exe file extensions from AV detections",
        "tool_name": "powershell",
        "reference": "https://github.com/Akabanwa-toma/hacke/blob/aaebb5cb188eb3a17bebfedfbde6b354e5522b92/installer.bat#L29C21-L29C63",
        "severity": "10",
        "popularity": "1",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0002",
        "techniques": "T1562.001 - T1059.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe -exec bypass -noni -nop -w 1 -C*invoke_obfuscation*",
        "description": "CrackMapExec behavior",
        "tool_name": "powershell",
        "reference": "https://github.com/Porchetta-Industries/CrackMapExec",
        "severity": "N/A",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0007 - TA0008",
        "techniques": "T1021 - T1048 - T1077 - T1087 - T1090 - T1135 - T1210",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*New-ItemProperty * \"EnableModuleLogging\" -PropertyType DWord -Value 0*",
        "description": "disable powershell logging",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0043",
        "techniques": "T1484.001 - T1112 - T1491.001 - T1490 - T1036.001 - T1089",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*powershell.exe -noni -nop -w 1 -enc *",
        "description": "command pattern used by crackmapexec by default A swiss army knife for pentesting networks",
        "tool_name": "powershell",
        "reference": "https://github.com/byt3bl33d3r/CrackMapExec",
        "severity": "N/A",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "High risk of false positive",
        "tactics": "N/A",
        "techniques": "T1210  T1570 T1021 T1595 T1592 T1589 T1590 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*New-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" -Name * -Value 0 -PropertyType Dword*",
        "description": "hiding a user from the login screen by modifying a specific registry key",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "9",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0003",
        "techniques": "T1112 - T1564.001",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Add-MpPreference -ExclustionPath c:\\users\\public*",
        "description": "Windows Defender evasion add an exclusion directory for your shady stuff",
        "tool_name": "powershell",
        "reference": "https://casvancooten.com/posts/2020/11/windows-active-directory-exploitation-cheat-sheet-and-command-reference",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "N/A",
        "techniques": "T1548 T1562 T1027 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "Set-ADObject -SamAccountName * -PropertyName scriptpath -PropertyValue *\\*.exe*",
        "description": "AD module Logon Script from remote IP",
        "tool_name": "powershell",
        "reference": "https://hideandsec.sh/books/cheatsheets-82c/page/active-directory",
        "severity": "7",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "AD Enumeration",
        "tactics": "TA0002 - TA0007 - TA0040",
        "techniques": "T1037.001 - T1078.003 - T1046",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*http://*Microsoft.ActiveDirectory.Management.dll*",
        "description": "redteam technique - import the ActiveDirectory module without the need to install it on the current computer - the dll has been extracted from a Windows 10 x64 with RSAT installed",
        "tool_name": "powershell",
        "reference": "https://github.com/mthcht/Purpleteam/blob/main/Simulation/Windows/ActiveDirectory/Bruteforce.ps1",
        "severity": "N/A",
        "popularity": "2",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0006",
        "techniques": "T1110.001 - T1110.003 - T1110.004",
        "endpoint_detection": true,
        "network_detection": true
    },
    {
        "keyword": "*[System.Environment]::GetEnvironmentVariable('username')*",
        "description": "alternativeto whoami",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "3",
        "popularity": "6",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007",
        "techniques": "T1033 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\\\:C*",
        "description": "powershell obfuscations techniques observed by malwares - reversed c:\\\\",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0003 - TA0005 - TA0006",
        "techniques": "T1021 - T1024 - T1027 - T1035 - T1059 - T1070",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\powershell.exe* +=hidden*",
        "description": "command aiming to hide a file. It can be performed with  powershell on a WINDOWS machine with command option =hidden",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0040 - TA0002",
        "techniques": "T1562.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-ItemProperty * \"EnableModuleLogging\" -Value 0*",
        "description": "disable powershell logging",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0005 - TA0043",
        "techniques": "T1484.001 - T1112 - T1491.001 - T1490 - T1036.001 - T1089",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*root/SecurityCenter2* -ClassName AntiVirusProduct*",
        "description": "list AV products with powershell",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "2",
        "popularity": "9",
        "keyword_type": "greyware_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0007 - TA0005",
        "techniques": "T1518.001 - T1082",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-MpPreference -ExclusionPath * -DisableRealtimeMonitoring*",
        "description": "Windows Defender evasion add an exclusion directory for your shady stuff",
        "tool_name": "powershell",
        "reference": "https://casvancooten.com/posts/2020/11/windows-active-directory-exploitation-cheat-sheet-and-command-reference",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "https://github.com/alperenugurlu/AD_Enumeration_Hunt/blob/alperen_ugurlu_hack/AD_Enumeration_Hunt.ps1",
        "tactics": "N/A",
        "techniques": "T1548 T1562 T1027 ",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*\\powershell.exe* += hidden*",
        "description": "command aiming to hide a file. It can be performed with  powershell on a WINDOWS machine with command option =hidden",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "N/A",
        "popularity": "N/A",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0040 - TA0002",
        "techniques": "T1562.002",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*llehsrewop*",
        "description": "powershell obfuscations techniques observed by malwares - reversed powershell",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "offensive_tool_keyword",
        "comment": "N/A",
        "tactics": "TA0001 - TA0002 - TA0003 - TA0005 - TA0006",
        "techniques": "T1021 - T1024 - T1027 - T1035 - T1059 - T1070",
        "endpoint_detection": true,
        "network_detection": false
    },
    {
        "keyword": "*Set-MpPreference -DisableScriptScanning 1 *",
        "description": "Disable AMSI (set to 0 to enable)",
        "tool_name": "powershell",
        "reference": "N/A",
        "severity": "10",
        "popularity": "10",
        "keyword_type": "greyware_tool_keyword",
        "comment": "greyware tool - risks of False positive !",
        "tactics": "TA0007 - TA0040 - TA0005",
        "techniques": "T1562.001 - T1562.002 - T1070.004",
        "endpoint_detection": true,
        "network_detection": false
    }
]