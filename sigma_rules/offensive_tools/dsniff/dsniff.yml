title: Simple keyword detection rule for dsniff
id: 12780ebb-ee0b-4379-a8cf-22922930e513
status: experimental
description:
- '''password sniffer. handles FTP. Telnet. SMTP. HTTP. POP. poppass. NNTP. IMAP.
  SNMP. LDAP. Rlogin. RIP. OSPF. PPTP  MS-CHAP. NFS. VRRP. YP/NIS. SOCKS. X11. CVS.
  IRC. AIM. ICQ. Napster. PostgreSQL. Meeting Maker. Citrix ICA. Symantec pcAnywhere.
  NAI Sniffer. Microsoft SMB. Oracle SQL*Net. Sybase and Microsoft SQL auth info.
  dsniff automatically detects and minimally parses each application protocol. only
  saving the interesting bits. and uses Berkeley DB as its output file format. only
  logging unique authentication attempts. full TCP/IP reassembly is provided by libnids(3)
  (likewise for the following tools as well).'''
- '''password sniffer. handles FTP. Telnet. SMTP. HTTP. POP. poppass. NNTP. IMAP.
  SNMP. LDAP. Rlogin. RIP. OSPF. PPTP MS-CHAP. NFS. VRRP. YP/NIS. SOCKS. X11. CVS.
  IRC. AIM. ICQ. Napster. PostgreSQL. Meeting Maker. Citrix ICA. Symantec  pcAnywhere.
  NAI Sniffer. Microsoft SMB. Oracle SQL*Net. Sybase and Microsoft SQL auth info.
  dsniff automatically detects and minimally parses each application protocol. only
  saving the interesting bits. and uses Berkeley DB as its output file format. only
  logging unique authentication attempts. full TCP/IP reassembly is provided by libnids(3)
  (likewise for the following tools as well)'''
- '''password sniffer. handles FTP. Telnet. SMTP. HTTP. POP. poppass. NNTP. IMAP.
  SNMP. LDAP. Rlogin. RIP. OSPF. PPTP MS-CHAP. NFS. VRRP. YP/NIS. SOCKS. X11. CVS.
  IRC. AIM. ICQ. Napster. PostgreSQL. Meeting Maker. Citrix ICA. Symantec pcAnywhere.
  NAI Sniffer. Microsoft SMB. Oracle SQL*Net. Sybase and Microsoft SQL auth info.
  dsniff automatically detects and minimally parses each application protocol. only
  saving the interesting bits. and uses Berkeley DB as its output file format. only
  logging unique authentication attempts. full TCP/IP reassembly is provided by libnids(3)
  (likewise for the following tools as well).'''
- '''password sniffer. handles FTP. Telnet. SMTP. HTTP. POP. poppass. NNTP. IMAP.
  SNMP. LDAP. Rlogin. RIP. OSPF. PPTP MS-CHAP. NFS. VRRP. YP/NIS. SOCKS. X11. CVS.
  IRC. AIM. ICQ. Napster. PostgreSQL. Meeting Maker. Citrix ICA. SymantecpcAnywhere.
  NAI Sniffer. Microsoft SMB. Oracle SQL*Net. Sybase and Microsoft SQL auth info.
  dsniff automatically detects and minimally parses each application protocol. only
  saving the interesting bits. and uses Berkeley DB as its output file format. only
  logging unique authentication attempts. full TCP/IP reassembly is provided by libnids(3)
  (likewise for the following tools as well).'''
references:
- https://github.com/tecknicaltom/dsniff
author: '@mthcht'
date: 2023/07/30
modified: 2023/08/28
tags:
- attack.T1040
- attack.T1074.001
- attack.T1110
- attack.T1555.002
- attack.T1555.003
- attack.TA0001
- attack.TA0002
- attack.TA0006
- attack.TA0007
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- Unknown
detection:
  selection:
    Image:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    OriginalFileName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    CurrentDirectory:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ParentImage:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ParentCommandLine:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    TargetFilename:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Signature:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    signature:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ImageLoaded:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Company:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Description:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    description:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    CommandLine:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    SourceImage:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    TargetImage:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    CallTrace:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    TargetObject:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Details:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    PipeName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Consumer:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Destination:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Query:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    NewName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    StartAddress:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    StartModule:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    StartFunction:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    SourceHostname:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Device:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    file_name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    file_path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    original_file_name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    parent_process:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process_path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    service_path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    registry_path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    registry_value_data:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    registry_value_name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ContextInfo:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Payload:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ScriptBlockText:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ServerName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    TransportName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    NewProcessName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ParentProcessName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Application:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Product Name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Threat Name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Process Name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    Path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ImagePath:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ServiceName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ProcessPath:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    AppName:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    AppPath:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    ModulePath:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    registry.data.strings:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    registry.path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    registry.value:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process.args:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process.command_line:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process.env_vars:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process.io.text:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process.executable:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process.name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    process.title:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    pe.company:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    pe.description:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    pe.original_file_name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    pe.product:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    os.full:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    host.hostname:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    file.fork_name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    file.name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    file.path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    file.target_path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    email.attachments.file.name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    email.subject:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    dll.path:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    device.model.name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    container.image.name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    container.name:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
    object:
    - '*/dsniff.c*'
    - '*/dnsspoof.c*'
    - '*/dsniff.services*'
    - '*tecknicaltom/dsniff*'
  condition: selection
fields:
- Image
- OriginalFileName
- CurrentDirectory
- ParentImage
- ParentCommandLine
- TargetFilename
- Signature
- signature
- ImageLoaded
- Company
- Description
- description
- CommandLine
- SourceImage
- TargetImage
- CallTrace
- TargetObject
- Details
- PipeName
- Consumer
- Destination
- Name
- Query
- NewName
- StartAddress
- StartModule
- StartFunction
- SourceHostname
- Device
- file_name
- file_path
- process
- original_file_name
- parent_process
- process_path
- service_path
- registry_path
- registry_value_data
- registry_value_name
- ContextInfo
- Payload
- ScriptBlockText
- ServerName
- TransportName
- NewProcessName
- ParentProcessName
- Application
- Product Name
- Threat Name
- Process Name
- Path
- ImagePath
- ServiceName
- ProcessPath
- AppName
- AppPath
- ModulePath
- registry.data.strings
- registry.path
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.executable
- process.name
- process.title
- pe.company
- pe.description
- pe.original_file_name
- pe.product
- os.full
- host.hostname
- file.fork_name
- file.name
- file.path
- file.target_path
- email.attachments.file.name
- email.subject
- dll.path
- device.model.name
- container.image.name
- container.name
- object
