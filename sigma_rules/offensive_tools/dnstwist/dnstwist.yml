title: Simple keyword detection rule for dnstwist
id: f9c983f5-4fce-4b3b-a075-f4c0523b7803
status: experimental
description:
- '''See what sort of trouble users can get in trying to type your domain name. Find
  lookalike domains that adversaries can use to attack you. Can detect typosquatters.
  phishing attacks. fraud. and brand impersonation. Useful as an additional source
  of targeted threat intelligence.'''
references:
- https://github.com/elceef/dnstwist
author: '@mthcht'
date: 2023/07/30
modified: 2023/08/02
tags:
- attack.T1560
- attack.T1565
- attack.T1566
- attack.T1568
- attack.T1569
- attack.TA0002
- attack.TA0005
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- Unknown
detection:
  selection:
    Image:
    - '*dnstwist*'
    OriginalFileName:
    - '*dnstwist*'
    CurrentDirectory:
    - '*dnstwist*'
    ParentImage:
    - '*dnstwist*'
    ParentCommandLine:
    - '*dnstwist*'
    TargetFilename:
    - '*dnstwist*'
    Signature:
    - '*dnstwist*'
    signature:
    - '*dnstwist*'
    ImageLoaded:
    - '*dnstwist*'
    Company:
    - '*dnstwist*'
    Description:
    - '*dnstwist*'
    description:
    - '*dnstwist*'
    CommandLine:
    - '*dnstwist*'
    SourceImage:
    - '*dnstwist*'
    TargetImage:
    - '*dnstwist*'
    CallTrace:
    - '*dnstwist*'
    TargetObject:
    - '*dnstwist*'
    Details:
    - '*dnstwist*'
    PipeName:
    - '*dnstwist*'
    Consumer:
    - '*dnstwist*'
    Destination:
    - '*dnstwist*'
    Name:
    - '*dnstwist*'
    Query:
    - '*dnstwist*'
    NewName:
    - '*dnstwist*'
    StartAddress:
    - '*dnstwist*'
    StartModule:
    - '*dnstwist*'
    StartFunction:
    - '*dnstwist*'
    SourceHostname:
    - '*dnstwist*'
    Device:
    - '*dnstwist*'
    file_name:
    - '*dnstwist*'
    file_path:
    - '*dnstwist*'
    process:
    - '*dnstwist*'
    original_file_name:
    - '*dnstwist*'
    parent_process:
    - '*dnstwist*'
    process_path:
    - '*dnstwist*'
    service_path:
    - '*dnstwist*'
    registry_path:
    - '*dnstwist*'
    registry_value_data:
    - '*dnstwist*'
    registry_value_name:
    - '*dnstwist*'
    ContextInfo:
    - '*dnstwist*'
    Payload:
    - '*dnstwist*'
    ScriptBlockText:
    - '*dnstwist*'
    ServerName:
    - '*dnstwist*'
    TransportName:
    - '*dnstwist*'
    NewProcessName:
    - '*dnstwist*'
    ParentProcessName:
    - '*dnstwist*'
    Application:
    - '*dnstwist*'
    Product Name:
    - '*dnstwist*'
    Threat Name:
    - '*dnstwist*'
    Process Name:
    - '*dnstwist*'
    Path:
    - '*dnstwist*'
    ImagePath:
    - '*dnstwist*'
    ServiceName:
    - '*dnstwist*'
    ProcessPath:
    - '*dnstwist*'
    AppName:
    - '*dnstwist*'
    AppPath:
    - '*dnstwist*'
    ModulePath:
    - '*dnstwist*'
    registry.data.strings:
    - '*dnstwist*'
    registry.path:
    - '*dnstwist*'
    registry.value:
    - '*dnstwist*'
    process.args:
    - '*dnstwist*'
    process.command_line:
    - '*dnstwist*'
    process.env_vars:
    - '*dnstwist*'
    process.io.text:
    - '*dnstwist*'
    process.executable:
    - '*dnstwist*'
    process.name:
    - '*dnstwist*'
    process.title:
    - '*dnstwist*'
    pe.company:
    - '*dnstwist*'
    pe.description:
    - '*dnstwist*'
    pe.original_file_name:
    - '*dnstwist*'
    pe.product:
    - '*dnstwist*'
    os.full:
    - '*dnstwist*'
    host.hostname:
    - '*dnstwist*'
    file.fork_name:
    - '*dnstwist*'
    file.name:
    - '*dnstwist*'
    file.path:
    - '*dnstwist*'
    file.target_path:
    - '*dnstwist*'
    email.attachments.file.name:
    - '*dnstwist*'
    email.subject:
    - '*dnstwist*'
    dll.path:
    - '*dnstwist*'
    device.model.name:
    - '*dnstwist*'
    container.image.name:
    - '*dnstwist*'
    container.name:
    - '*dnstwist*'
    object:
    - '*dnstwist*'
  condition: selection
fields:
- Image
- OriginalFileName
- CurrentDirectory
- ParentImage
- ParentCommandLine
- TargetFilename
- Signature
- signature
- ImageLoaded
- Company
- Description
- description
- CommandLine
- SourceImage
- TargetImage
- CallTrace
- TargetObject
- Details
- PipeName
- Consumer
- Destination
- Name
- Query
- NewName
- StartAddress
- StartModule
- StartFunction
- SourceHostname
- Device
- file_name
- file_path
- process
- original_file_name
- parent_process
- process_path
- service_path
- registry_path
- registry_value_data
- registry_value_name
- ContextInfo
- Payload
- ScriptBlockText
- ServerName
- TransportName
- NewProcessName
- ParentProcessName
- Application
- Product Name
- Threat Name
- Process Name
- Path
- ImagePath
- ServiceName
- ProcessPath
- AppName
- AppPath
- ModulePath
- registry.data.strings
- registry.path
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.executable
- process.name
- process.title
- pe.company
- pe.description
- pe.original_file_name
- pe.product
- os.full
- host.hostname
- file.fork_name
- file.name
- file.path
- file.target_path
- email.attachments.file.name
- email.subject
- dll.path
- device.model.name
- container.image.name
- container.name
- object
