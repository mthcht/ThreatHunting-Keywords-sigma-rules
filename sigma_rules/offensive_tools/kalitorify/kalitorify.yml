title: Simple keyword detection rule for kalitorify
id: 14d58bd1-eac5-415a-b916-29fa28d4364f
status: experimental
description:
- '''kalitorify is a shell script for Kali Linux which use iptables settings to create
  a Transparent Proxy through the Tor Network. the program also allows you to perform
  various checks like checking the Tor Exit Node (i.e. your public IP when you are
  under Tor proxy). or if Tor has been configured correctly checking service and network
  settings.'''
references:
- https://github.com/brainfucksec/kalitorify
author: '@mthcht'
date: 2023/07/30
modified: 2023/09/11
tags:
- attack.T1016
- attack.T1046
- attack.T1090
- attack.T1132
- attack.TA0003
- attack.TA0011
- attack.TA0040
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- Unknown
detection:
  selection:
    Image:
    - '*kalitorify*'
    OriginalFileName:
    - '*kalitorify*'
    CurrentDirectory:
    - '*kalitorify*'
    ParentImage:
    - '*kalitorify*'
    ParentCommandLine:
    - '*kalitorify*'
    TargetFilename:
    - '*kalitorify*'
    Signature:
    - '*kalitorify*'
    signature:
    - '*kalitorify*'
    ImageLoaded:
    - '*kalitorify*'
    Company:
    - '*kalitorify*'
    Description:
    - '*kalitorify*'
    description:
    - '*kalitorify*'
    CommandLine:
    - '*kalitorify*'
    SourceImage:
    - '*kalitorify*'
    TargetImage:
    - '*kalitorify*'
    CallTrace:
    - '*kalitorify*'
    TargetObject:
    - '*kalitorify*'
    Details:
    - '*kalitorify*'
    PipeName:
    - '*kalitorify*'
    Consumer:
    - '*kalitorify*'
    Destination:
    - '*kalitorify*'
    Name:
    - '*kalitorify*'
    Query:
    - '*kalitorify*'
    NewName:
    - '*kalitorify*'
    StartAddress:
    - '*kalitorify*'
    StartModule:
    - '*kalitorify*'
    StartFunction:
    - '*kalitorify*'
    SourceHostname:
    - '*kalitorify*'
    Device:
    - '*kalitorify*'
    file_name:
    - '*kalitorify*'
    file_path:
    - '*kalitorify*'
    process:
    - '*kalitorify*'
    original_file_name:
    - '*kalitorify*'
    parent_process:
    - '*kalitorify*'
    process_path:
    - '*kalitorify*'
    service_path:
    - '*kalitorify*'
    registry_path:
    - '*kalitorify*'
    registry_value_data:
    - '*kalitorify*'
    registry_value_name:
    - '*kalitorify*'
    ContextInfo:
    - '*kalitorify*'
    Payload:
    - '*kalitorify*'
    ScriptBlockText:
    - '*kalitorify*'
    ServerName:
    - '*kalitorify*'
    TransportName:
    - '*kalitorify*'
    NewProcessName:
    - '*kalitorify*'
    ParentProcessName:
    - '*kalitorify*'
    Application:
    - '*kalitorify*'
    Product Name:
    - '*kalitorify*'
    Threat Name:
    - '*kalitorify*'
    Process Name:
    - '*kalitorify*'
    Path:
    - '*kalitorify*'
    ImagePath:
    - '*kalitorify*'
    ServiceName:
    - '*kalitorify*'
    ProcessPath:
    - '*kalitorify*'
    AppName:
    - '*kalitorify*'
    AppPath:
    - '*kalitorify*'
    ModulePath:
    - '*kalitorify*'
    registry.data.strings:
    - '*kalitorify*'
    registry.path:
    - '*kalitorify*'
    registry.value:
    - '*kalitorify*'
    process.args:
    - '*kalitorify*'
    process.command_line:
    - '*kalitorify*'
    process.env_vars:
    - '*kalitorify*'
    process.io.text:
    - '*kalitorify*'
    process.executable:
    - '*kalitorify*'
    process.name:
    - '*kalitorify*'
    process.title:
    - '*kalitorify*'
    pe.company:
    - '*kalitorify*'
    pe.description:
    - '*kalitorify*'
    pe.original_file_name:
    - '*kalitorify*'
    pe.product:
    - '*kalitorify*'
    os.full:
    - '*kalitorify*'
    host.hostname:
    - '*kalitorify*'
    file.fork_name:
    - '*kalitorify*'
    file.name:
    - '*kalitorify*'
    file.path:
    - '*kalitorify*'
    file.target_path:
    - '*kalitorify*'
    email.attachments.file.name:
    - '*kalitorify*'
    email.subject:
    - '*kalitorify*'
    dll.path:
    - '*kalitorify*'
    device.model.name:
    - '*kalitorify*'
    container.image.name:
    - '*kalitorify*'
    container.name:
    - '*kalitorify*'
    object:
    - '*kalitorify*'
  condition: selection
fields:
- Image
- OriginalFileName
- CurrentDirectory
- ParentImage
- ParentCommandLine
- TargetFilename
- Signature
- signature
- ImageLoaded
- Company
- Description
- description
- CommandLine
- SourceImage
- TargetImage
- CallTrace
- TargetObject
- Details
- PipeName
- Consumer
- Destination
- Name
- Query
- NewName
- StartAddress
- StartModule
- StartFunction
- SourceHostname
- Device
- file_name
- file_path
- process
- original_file_name
- parent_process
- process_path
- service_path
- registry_path
- registry_value_data
- registry_value_name
- ContextInfo
- Payload
- ScriptBlockText
- ServerName
- TransportName
- NewProcessName
- ParentProcessName
- Application
- Product Name
- Threat Name
- Process Name
- Path
- ImagePath
- ServiceName
- ProcessPath
- AppName
- AppPath
- ModulePath
- registry.data.strings
- registry.path
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.executable
- process.name
- process.title
- pe.company
- pe.description
- pe.original_file_name
- pe.product
- os.full
- host.hostname
- file.fork_name
- file.name
- file.path
- file.target_path
- email.attachments.file.name
- email.subject
- dll.path
- device.model.name
- container.image.name
- container.name
- object
