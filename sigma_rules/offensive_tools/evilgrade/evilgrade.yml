title: Simple keyword detection rule for evilgrade
id: f9ad2e57-0c35-4b52-a5ce-e3fefada04a3
status: experimental
description:
- '''Evilgrade is a modular framework that allows the user to take advantage of poor
  upgrade implementations by injecting fake updates. It comes with pre-made binaries
  (agents). a working default configuration for fast pentests. and has its own WebServer
  and DNSServer modules. Easy to set up new settings. and has an autoconfiguration
  when new binary agents are set'''
references:
- https://github.com/infobyte/evilgrade
author: '@mthcht'
date: 2023/07/30
modified: 2023/08/06
tags:
- attack.
- attack.T1203
- attack.T1210
- attack.T1211
- attack.T1212
- attack.T1565
- attack.T1566
- attack.T1573
- 'attack.TA0002 '
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- Unknown
detection:
  selection:
    Image:
    - '*evilgrade*'
    OriginalFileName:
    - '*evilgrade*'
    CurrentDirectory:
    - '*evilgrade*'
    ParentImage:
    - '*evilgrade*'
    ParentCommandLine:
    - '*evilgrade*'
    TargetFilename:
    - '*evilgrade*'
    Signature:
    - '*evilgrade*'
    signature:
    - '*evilgrade*'
    ImageLoaded:
    - '*evilgrade*'
    Company:
    - '*evilgrade*'
    Description:
    - '*evilgrade*'
    description:
    - '*evilgrade*'
    CommandLine:
    - '*evilgrade*'
    SourceImage:
    - '*evilgrade*'
    TargetImage:
    - '*evilgrade*'
    CallTrace:
    - '*evilgrade*'
    TargetObject:
    - '*evilgrade*'
    Details:
    - '*evilgrade*'
    PipeName:
    - '*evilgrade*'
    Consumer:
    - '*evilgrade*'
    Destination:
    - '*evilgrade*'
    Name:
    - '*evilgrade*'
    Query:
    - '*evilgrade*'
    NewName:
    - '*evilgrade*'
    StartAddress:
    - '*evilgrade*'
    StartModule:
    - '*evilgrade*'
    StartFunction:
    - '*evilgrade*'
    SourceHostname:
    - '*evilgrade*'
    Device:
    - '*evilgrade*'
    file_name:
    - '*evilgrade*'
    file_path:
    - '*evilgrade*'
    process:
    - '*evilgrade*'
    original_file_name:
    - '*evilgrade*'
    parent_process:
    - '*evilgrade*'
    process_path:
    - '*evilgrade*'
    service_path:
    - '*evilgrade*'
    registry_path:
    - '*evilgrade*'
    registry_value_data:
    - '*evilgrade*'
    registry_value_name:
    - '*evilgrade*'
    ContextInfo:
    - '*evilgrade*'
    Payload:
    - '*evilgrade*'
    ScriptBlockText:
    - '*evilgrade*'
    ServerName:
    - '*evilgrade*'
    TransportName:
    - '*evilgrade*'
    NewProcessName:
    - '*evilgrade*'
    ParentProcessName:
    - '*evilgrade*'
    Application:
    - '*evilgrade*'
    Product Name:
    - '*evilgrade*'
    Threat Name:
    - '*evilgrade*'
    Process Name:
    - '*evilgrade*'
    Path:
    - '*evilgrade*'
    ImagePath:
    - '*evilgrade*'
    ServiceName:
    - '*evilgrade*'
    ProcessPath:
    - '*evilgrade*'
    AppName:
    - '*evilgrade*'
    AppPath:
    - '*evilgrade*'
    ModulePath:
    - '*evilgrade*'
    registry.data.strings:
    - '*evilgrade*'
    registry.path:
    - '*evilgrade*'
    registry.value:
    - '*evilgrade*'
    process.args:
    - '*evilgrade*'
    process.command_line:
    - '*evilgrade*'
    process.env_vars:
    - '*evilgrade*'
    process.io.text:
    - '*evilgrade*'
    process.executable:
    - '*evilgrade*'
    process.name:
    - '*evilgrade*'
    process.title:
    - '*evilgrade*'
    pe.company:
    - '*evilgrade*'
    pe.description:
    - '*evilgrade*'
    pe.original_file_name:
    - '*evilgrade*'
    pe.product:
    - '*evilgrade*'
    os.full:
    - '*evilgrade*'
    host.hostname:
    - '*evilgrade*'
    file.fork_name:
    - '*evilgrade*'
    file.name:
    - '*evilgrade*'
    file.path:
    - '*evilgrade*'
    file.target_path:
    - '*evilgrade*'
    email.attachments.file.name:
    - '*evilgrade*'
    email.subject:
    - '*evilgrade*'
    dll.path:
    - '*evilgrade*'
    device.model.name:
    - '*evilgrade*'
    container.image.name:
    - '*evilgrade*'
    container.name:
    - '*evilgrade*'
    object:
    - '*evilgrade*'
  condition: selection
fields:
- Image
- OriginalFileName
- CurrentDirectory
- ParentImage
- ParentCommandLine
- TargetFilename
- Signature
- signature
- ImageLoaded
- Company
- Description
- description
- CommandLine
- SourceImage
- TargetImage
- CallTrace
- TargetObject
- Details
- PipeName
- Consumer
- Destination
- Name
- Query
- NewName
- StartAddress
- StartModule
- StartFunction
- SourceHostname
- Device
- file_name
- file_path
- process
- original_file_name
- parent_process
- process_path
- service_path
- registry_path
- registry_value_data
- registry_value_name
- ContextInfo
- Payload
- ScriptBlockText
- ServerName
- TransportName
- NewProcessName
- ParentProcessName
- Application
- Product Name
- Threat Name
- Process Name
- Path
- ImagePath
- ServiceName
- ProcessPath
- AppName
- AppPath
- ModulePath
- registry.data.strings
- registry.path
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.executable
- process.name
- process.title
- pe.company
- pe.description
- pe.original_file_name
- pe.product
- os.full
- host.hostname
- file.fork_name
- file.name
- file.path
- file.target_path
- email.attachments.file.name
- email.subject
- dll.path
- device.model.name
- container.image.name
- container.name
- object
