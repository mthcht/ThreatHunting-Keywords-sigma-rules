title: Simple keyword detection rule for BloodHound.py
id: 869c3baf-aee4-430b-8052-d36a698d2bcf
status: experimental
description:
- '''BloodHound is a single page Javascript web application. built on top of Linkurious.
  compiled with Electron. with a Neo4j database fed by a C# data collector. BloodHound
  uses graph theory to reveal the hidden and often unintended relationships within
  an Active Directory environment. Attackers can use BloodHound to easily identify
  highly complex attack paths that would otherwise be impossible to quickly identify.
  Defenders can use BloodHound to identify and eliminate those same attack paths.
  Both blue and red teams can use BloodHound to easily gain a deeper understanding
  of privilege relationships in an Active Directory environment'''
references:
- https://github.com/fox-it/BloodHound.py
author: '@mthcht'
date: 2023/07/30
modified: 2023/09/01
tags:
- attack.T1069
- attack.TA0007
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- critical
detection:
  selection:
    Image:
    - '*bloodhound.py *'
    OriginalFileName:
    - '*bloodhound.py *'
    CurrentDirectory:
    - '*bloodhound.py *'
    ParentImage:
    - '*bloodhound.py *'
    ParentCommandLine:
    - '*bloodhound.py *'
    TargetFilename:
    - '*bloodhound.py *'
    Signature:
    - '*bloodhound.py *'
    signature:
    - '*bloodhound.py *'
    ImageLoaded:
    - '*bloodhound.py *'
    Company:
    - '*bloodhound.py *'
    Description:
    - '*bloodhound.py *'
    description:
    - '*bloodhound.py *'
    CommandLine:
    - '*bloodhound.py *'
    SourceImage:
    - '*bloodhound.py *'
    TargetImage:
    - '*bloodhound.py *'
    CallTrace:
    - '*bloodhound.py *'
    TargetObject:
    - '*bloodhound.py *'
    Details:
    - '*bloodhound.py *'
    PipeName:
    - '*bloodhound.py *'
    Consumer:
    - '*bloodhound.py *'
    Destination:
    - '*bloodhound.py *'
    Name:
    - '*bloodhound.py *'
    Query:
    - '*bloodhound.py *'
    NewName:
    - '*bloodhound.py *'
    StartAddress:
    - '*bloodhound.py *'
    StartModule:
    - '*bloodhound.py *'
    StartFunction:
    - '*bloodhound.py *'
    SourceHostname:
    - '*bloodhound.py *'
    Device:
    - '*bloodhound.py *'
    file_name:
    - '*bloodhound.py *'
    file_path:
    - '*bloodhound.py *'
    process:
    - '*bloodhound.py *'
    original_file_name:
    - '*bloodhound.py *'
    parent_process:
    - '*bloodhound.py *'
    process_path:
    - '*bloodhound.py *'
    service_path:
    - '*bloodhound.py *'
    registry_path:
    - '*bloodhound.py *'
    registry_value_data:
    - '*bloodhound.py *'
    registry_value_name:
    - '*bloodhound.py *'
    ContextInfo:
    - '*bloodhound.py *'
    Payload:
    - '*bloodhound.py *'
    ScriptBlockText:
    - '*bloodhound.py *'
    ServerName:
    - '*bloodhound.py *'
    TransportName:
    - '*bloodhound.py *'
    NewProcessName:
    - '*bloodhound.py *'
    ParentProcessName:
    - '*bloodhound.py *'
    Application:
    - '*bloodhound.py *'
    Product Name:
    - '*bloodhound.py *'
    Threat Name:
    - '*bloodhound.py *'
    Process Name:
    - '*bloodhound.py *'
    Path:
    - '*bloodhound.py *'
    ImagePath:
    - '*bloodhound.py *'
    ServiceName:
    - '*bloodhound.py *'
    ProcessPath:
    - '*bloodhound.py *'
    AppName:
    - '*bloodhound.py *'
    AppPath:
    - '*bloodhound.py *'
    ModulePath:
    - '*bloodhound.py *'
    registry.data.strings:
    - '*bloodhound.py *'
    registry.path:
    - '*bloodhound.py *'
    registry.value:
    - '*bloodhound.py *'
    process.args:
    - '*bloodhound.py *'
    process.command_line:
    - '*bloodhound.py *'
    process.env_vars:
    - '*bloodhound.py *'
    process.io.text:
    - '*bloodhound.py *'
    process.executable:
    - '*bloodhound.py *'
    process.name:
    - '*bloodhound.py *'
    process.title:
    - '*bloodhound.py *'
    pe.company:
    - '*bloodhound.py *'
    pe.description:
    - '*bloodhound.py *'
    pe.original_file_name:
    - '*bloodhound.py *'
    pe.product:
    - '*bloodhound.py *'
    os.full:
    - '*bloodhound.py *'
    host.hostname:
    - '*bloodhound.py *'
    file.fork_name:
    - '*bloodhound.py *'
    file.name:
    - '*bloodhound.py *'
    file.path:
    - '*bloodhound.py *'
    file.target_path:
    - '*bloodhound.py *'
    email.attachments.file.name:
    - '*bloodhound.py *'
    email.subject:
    - '*bloodhound.py *'
    dll.path:
    - '*bloodhound.py *'
    device.model.name:
    - '*bloodhound.py *'
    container.image.name:
    - '*bloodhound.py *'
    container.name:
    - '*bloodhound.py *'
    object:
    - '*bloodhound.py *'
  condition: selection
fields:
- Image
- OriginalFileName
- CurrentDirectory
- ParentImage
- ParentCommandLine
- TargetFilename
- Signature
- signature
- ImageLoaded
- Company
- Description
- description
- CommandLine
- SourceImage
- TargetImage
- CallTrace
- TargetObject
- Details
- PipeName
- Consumer
- Destination
- Name
- Query
- NewName
- StartAddress
- StartModule
- StartFunction
- SourceHostname
- Device
- file_name
- file_path
- process
- original_file_name
- parent_process
- process_path
- service_path
- registry_path
- registry_value_data
- registry_value_name
- ContextInfo
- Payload
- ScriptBlockText
- ServerName
- TransportName
- NewProcessName
- ParentProcessName
- Application
- Product Name
- Threat Name
- Process Name
- Path
- ImagePath
- ServiceName
- ProcessPath
- AppName
- AppPath
- ModulePath
- registry.data.strings
- registry.path
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.executable
- process.name
- process.title
- pe.company
- pe.description
- pe.original_file_name
- pe.product
- os.full
- host.hostname
- file.fork_name
- file.name
- file.path
- file.target_path
- email.attachments.file.name
- email.subject
- dll.path
- device.model.name
- container.image.name
- container.name
- object
