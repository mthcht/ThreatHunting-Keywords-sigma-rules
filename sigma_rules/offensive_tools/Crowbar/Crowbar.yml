title: Simple keyword detection rule for Crowbar
id: 9d34e8d1-8bd6-482e-bcce-ef6087cfc93f
status: experimental
description:
- '''Crowbar (formally known as Levye) is a brute forcing tool that can be used during
  penetration tests. It was developed to brute force some protocols in a different
  manner according to other popular brute forcing tools. As an example. while most
  brute forcing tools use username and password for SSH brute force. Crowbar uses
  SSH key(s). This allows for any private keys that have been obtained during penetration
  tests. to be used to attack other SSH servers.'''
references:
- https://github.com/galkan/crowbar
author: '@mthcht'
date: 2023/07/30
modified: 2023/08/17
tags:
- attack.T1051
- attack.T1110
- attack.T1114
- attack.T1189
- attack.T1552
- attack.TA0002
- attack.TA0006
- attack.TA0008
logsource:
  category:
  - endpoint
falsepositives:
- Unknown
level:
- Unknown
detection:
  selection:
    Image:
    - '*crowbar*'
    OriginalFileName:
    - '*crowbar*'
    CurrentDirectory:
    - '*crowbar*'
    ParentImage:
    - '*crowbar*'
    ParentCommandLine:
    - '*crowbar*'
    TargetFilename:
    - '*crowbar*'
    Signature:
    - '*crowbar*'
    signature:
    - '*crowbar*'
    ImageLoaded:
    - '*crowbar*'
    Company:
    - '*crowbar*'
    Description:
    - '*crowbar*'
    description:
    - '*crowbar*'
    CommandLine:
    - '*crowbar*'
    SourceImage:
    - '*crowbar*'
    TargetImage:
    - '*crowbar*'
    CallTrace:
    - '*crowbar*'
    TargetObject:
    - '*crowbar*'
    Details:
    - '*crowbar*'
    PipeName:
    - '*crowbar*'
    Consumer:
    - '*crowbar*'
    Destination:
    - '*crowbar*'
    Name:
    - '*crowbar*'
    Query:
    - '*crowbar*'
    NewName:
    - '*crowbar*'
    StartAddress:
    - '*crowbar*'
    StartModule:
    - '*crowbar*'
    StartFunction:
    - '*crowbar*'
    SourceHostname:
    - '*crowbar*'
    Device:
    - '*crowbar*'
    file_name:
    - '*crowbar*'
    file_path:
    - '*crowbar*'
    process:
    - '*crowbar*'
    original_file_name:
    - '*crowbar*'
    parent_process:
    - '*crowbar*'
    process_path:
    - '*crowbar*'
    service_path:
    - '*crowbar*'
    registry_path:
    - '*crowbar*'
    registry_value_data:
    - '*crowbar*'
    registry_value_name:
    - '*crowbar*'
    ContextInfo:
    - '*crowbar*'
    Payload:
    - '*crowbar*'
    ScriptBlockText:
    - '*crowbar*'
    ServerName:
    - '*crowbar*'
    TransportName:
    - '*crowbar*'
    NewProcessName:
    - '*crowbar*'
    ParentProcessName:
    - '*crowbar*'
    Application:
    - '*crowbar*'
    Product Name:
    - '*crowbar*'
    Threat Name:
    - '*crowbar*'
    Process Name:
    - '*crowbar*'
    Path:
    - '*crowbar*'
    ImagePath:
    - '*crowbar*'
    ServiceName:
    - '*crowbar*'
    ProcessPath:
    - '*crowbar*'
    AppName:
    - '*crowbar*'
    AppPath:
    - '*crowbar*'
    ModulePath:
    - '*crowbar*'
    registry.data.strings:
    - '*crowbar*'
    registry.path:
    - '*crowbar*'
    registry.value:
    - '*crowbar*'
    process.args:
    - '*crowbar*'
    process.command_line:
    - '*crowbar*'
    process.env_vars:
    - '*crowbar*'
    process.io.text:
    - '*crowbar*'
    process.executable:
    - '*crowbar*'
    process.name:
    - '*crowbar*'
    process.title:
    - '*crowbar*'
    pe.company:
    - '*crowbar*'
    pe.description:
    - '*crowbar*'
    pe.original_file_name:
    - '*crowbar*'
    pe.product:
    - '*crowbar*'
    os.full:
    - '*crowbar*'
    host.hostname:
    - '*crowbar*'
    file.fork_name:
    - '*crowbar*'
    file.name:
    - '*crowbar*'
    file.path:
    - '*crowbar*'
    file.target_path:
    - '*crowbar*'
    email.attachments.file.name:
    - '*crowbar*'
    email.subject:
    - '*crowbar*'
    dll.path:
    - '*crowbar*'
    device.model.name:
    - '*crowbar*'
    container.image.name:
    - '*crowbar*'
    container.name:
    - '*crowbar*'
    object:
    - '*crowbar*'
  condition: selection
fields:
- Image
- OriginalFileName
- CurrentDirectory
- ParentImage
- ParentCommandLine
- TargetFilename
- Signature
- signature
- ImageLoaded
- Company
- Description
- description
- CommandLine
- SourceImage
- TargetImage
- CallTrace
- TargetObject
- Details
- PipeName
- Consumer
- Destination
- Name
- Query
- NewName
- StartAddress
- StartModule
- StartFunction
- SourceHostname
- Device
- file_name
- file_path
- process
- original_file_name
- parent_process
- process_path
- service_path
- registry_path
- registry_value_data
- registry_value_name
- ContextInfo
- Payload
- ScriptBlockText
- ServerName
- TransportName
- NewProcessName
- ParentProcessName
- Application
- Product Name
- Threat Name
- Process Name
- Path
- ImagePath
- ServiceName
- ProcessPath
- AppName
- AppPath
- ModulePath
- registry.data.strings
- registry.path
- registry.value
- process.args
- process.command_line
- process.env_vars
- process.io.text
- process.executable
- process.name
- process.title
- pe.company
- pe.description
- pe.original_file_name
- pe.product
- os.full
- host.hostname
- file.fork_name
- file.name
- file.path
- file.target_path
- email.attachments.file.name
- email.subject
- dll.path
- device.model.name
- container.image.name
- container.name
- object
